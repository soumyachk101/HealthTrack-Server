{% extends 'base.html' %}
{% load static %}

{% block title %}Dashboard | HealthTrack+{% endblock %}
{% block body_class %}bg-background text-foreground antialiased{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'dist/assets/main.css' %}">
{% endblock %}

{% block content %}
<div id="root" data-page="Dashboard"></div>

<script id="dashboard-data" type="application/json">
{
    "user": {
        "name": "{{ request.user.first_name|default:request.user.username|escapejs }}"
    },
    "latest_record": {
        "blood_pressure_systolic": "{{ latest_record.blood_pressure_systolic|default:'' }}",
        "blood_pressure_diastolic": "{{ latest_record.blood_pressure_diastolic|default:'' }}",
        "bp_status": "{{ latest_record.bp_status|default:''|escapejs }}",
        "blood_sugar": "{{ latest_record.blood_sugar|default:'' }}",
        "weight": "{{ latest_record.weight|default:'' }}",
        "heart_rate": "{{ latest_record.heart_rate|default:'' }}"
    },
    "active_medicines": "{{ active_medicines|default:'0' }}",
    "active_medicines_count": "{{ active_medicines|default:'0' }}",
    "latest_mental_health": {
        "sleep_hours": "{{ latest_mental_health.sleep_hours|default:'' }}"
    },
    "recent_activities": [
        {% for activity in recent_activities %}
        {
            "action_display": "{{ activity.get_action_display|escapejs }}",
            "created_at_since": "{{ activity.created_at|timesince }}",
            "details": "{{ activity.details|truncatechars:30|escapejs }}"
        }{% if not forloop.last %},{% endif %}
        {% endfor %}
    ]
}
</script>
{% endblock %}

{% block extra_js %}
<script type="module" src="{% static 'dist/assets/main.js' %}"></script>
{% endblock %}